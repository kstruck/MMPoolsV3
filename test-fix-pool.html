<!DOCTYPE html>
<html>

<head>
    <title>Test Fix Pool Scores</title>
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFunctions, httpsCallable } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-functions.js';
        import { getAuth, signInAnonymously } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

        const firebaseConfig = {
            apiKey: "AIzaSyBOie3RNqG00xBqkVhT7X0t3lL9U47LWFU",
            authDomain: "gridiron-gamble-uzuqo.firebaseapp.com",
            projectId: "gridiron-gamble-uzuqo",
            storageBucket: "gridiron-gamble-uzuqo.firebasestorage.app",
            messagingSenderId: "478831945359",
            appId: "1:478831945359:web:a7de8f26c45d4f7c93b6de"
        };

        const app = initializeApp(firebaseConfig);
        const functions = getFunctions(app);
        const auth = getAuth(app);

        window.testFixPool = async function () {
            const poolId = '4BLlJSC7CGTAiK3SM6xO';
            const output = document.getElementById('output');

            output.innerHTML = 'Authenticating...<br>';

            try {
                // Sign in anonymously (auth is commented out anyway)
                await signInAnonymously(auth);
                output.innerHTML += 'Authenticated!<br>';

                output.innerHTML += `Calling fixPoolScores for pool: ${poolId}<br>`;

                const fixPoolScores = httpsCallable(functions, 'fixPoolScores');
                const result = await fixPoolScores({ poolId });

                output.innerHTML += '<br><strong>✅ SUCCESS!</strong><br>';
                output.innerHTML += '<pre>' + JSON.stringify(result.data, null, 2) + '</pre>';

            } catch (error) {
                output.innerHTML += '<br><strong>❌ ERROR:</strong><br>';
                output.innerHTML += '<pre>' + error.message + '</pre>';
                console.error(error);
            }
        };
    </script>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }

        #output {
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ccc;
            background: #f5f5f5;
            min-height: 100px;
        }

        pre {
            background: white;
            padding: 10px;
            overflow-x: auto;
        }
    </style>
</head>

<body>
    <h1>Test Fix Pool Scores</h1>
    <p>This will call the fixPoolScores function for pool: <strong>4BLlJSC7CGTAiK3SM6xO</strong></p>

    <button onclick="testFixPool()">Run Fix Pool Scores</button>

    <div id="output">Click button to test...</div>
</body>

</html>